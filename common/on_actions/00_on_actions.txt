#When adding effects directly in on_actions always consider if it would be best to do so through a scripted effect. on_actions with a lot of script in them are harder to get an overview of.

# country
on_startup = {
    emperor = {
		save_global_event_target_as = Emperor
	}
    
    A34 = {
        save_global_event_target_as = buring_legion_conduit_nation
    }
    
	if = {
		limit = {
			is_emperor_of_china = yes
		}
		save_global_event_target_as = celestial_emperor
	}
    
    events = {
        wwu_setup.1    # Global
        wwu_setup.2    # Country
	}
    
    unlock_initial_cults = yes
	setup_faction_system = yes
    
	if = {
		limit = { NOT = { has_global_flag = wwu_set_up_flag } }
		2505 = { remove_canal = gp_deeprun_tram_eastern_kingdoms }
		set_global_flag = wwu_set_up_flag
		if = {
			limit = {is_year = 592}
			set_global_flag = dark_portal_opened_flag
		}
		if = {
			limit = {is_year = 600}
			1586 = { remove_canal = gp_dark_portal_outland }
			clr_global_flag = dark_portal_opened_flag
			set_global_flag = dark_portal_closed_firsttime
			set_global_flag = sonsoflothar
			set_global_flag = khadgar
		}
		if = {
			limit = {is_year = 618}
			set_global_flag = archimonde_dead
			set_global_flag = eye_of_sargeras
			set_global_flag = sunfury_arrived
		}
		if = {
			limit = {is_year = 622}
			set_global_flag = illidan_frozen_throne
		}
	}
    
    set_variable = {
        which = cultures_converted
        value = 0
    }
	
	every_province = {
		limit = {
			culture_group = culture_group_scourge
			trade_goods = grain
		}
		change_trade_goods = crypts
	}
	
	every_province = {
		limit = {
			culture_group = culture_group_undead
			trade_goods = grain
		}
		change_trade_goods = crypts
	}
	
#	every_province = {
#		limit = {
#			NOT = { culture_group = culture_group_scourge }
#			trade_goods = crypts
#		}
#		change_trade_goods = grain
#	}

	every_province = {
		limit = {
			religion = fel
			trade_goods = arcane
		}
		change_trade_goods = fel
	}
	
	every_province = {
		limit = {
			religion = cult_of_the_damned
			trade_goods = arcane
		}
		change_trade_goods = fel
	}
	
	every_province = {
		limit = {
			NOT = { religion = fel }
			NOT = { religion = cult_of_the_damned }
			trade_goods = fel
		}
		change_trade_goods = arcane
	}
	
	1671 = {
		owner = {
			add_country_modifier = {
				name = lord_of_outland
				duration = -1
			}
		}
	}
}

# country
on_religion_change = {
	#log = "[Root.GetName]: Triggered religion_change"
    on_religion_change_estate_privileges_effect = yes
    
    if = {
        limit = {
            has_ruler_modifier = bastion_of_the_faith
        }
        remove_country_modifier = bastion_of_the_faith
    }
    
	if = {
		limit = {
			has_heir = yes
		}
		set_heir_religion = ROOT
	}
	if = {
		limit = {
			has_regency = no
		}
		set_ruler_religion = ROOT
	}
	if = {
		limit = {
			has_dlc = "Rights of Man"
			has_consort = yes
		}
		set_consort_religion = ROOT
	}
    add_country_modifier = {
		name = recently_changed_religion_dummy
		duration = 10
		hidden = yes
	}
    
	events = {
		#propagate_religion_events.7 #Propagated Country is now Muslim
	}
}

# country.
on_secondary_religion_change = {
	#log = "[Root.GetName]: Triggered secondary_religion_change"
}

# country. Spawned when Enforcing Rebel Demands through a Support Rebels-war.
on_enforce_rebel_demands = {
	#log = "[Root.GetName]: Triggered enforce_rebel_demands"
	# ROOT = The winning country
	# FROM = The loosing country
	set_country_flag = helped_rebels_win_war
}

# country
on_colonial_liberation = {
	#log = "[Root.GetName]: Triggered colonial_liberation"
	country_event = { id = colonial_nation.90 days = 1 }
}

# country
on_colonial_reintegration = {
	#log = "[Root.GetName]: Triggered colonial_reintegration"
	events = {
		colonial_nation.91
	}
}

# country
on_peace_actor = {
	#log = "[Root.GetName]: Triggered peace_actor"
	events = {
	}
}

# country
on_peace_recipient = {
	#log = "[Root.GetName]: Triggered peace_recipient"
	events = {
	}
}

# country
# root = winning country, from = loser country
on_war_won = {
	#log = "[Root.GetName]: Triggered war_won"
	ROOT = { 
		country_event = { id = tributary_events.32 }
		change_variable = {
			which = war_won
			value = 1
		}
	}
	events = {
        wwu_dragon_aspects.1
		on_action_special.2
        wwu_elemental_attunement.1 # Triumph of the Elements 
	}
}

# country
# root = loser country, from = winner country
on_war_lost = {
	#log = "[Root.GetName]: Triggered war_lost"
	ROOT = { country_event = { id = tributary_events.32 } }
    
	change_variable = {
		which = war_lost
		value = 1
	}
    add_country_modifier = {
		name = just_lost_war_timer
		duration = 10
		hidden = yes
	}
    
	events = {
        wwu_dragon_aspects.2
		on_action_special.2
        wwu_elemental_attunement.2 # Sorrow of the Elements
        wwu_bastion_of_the_faith.1
	}
}

# country
# root = winning country, from = loser country
on_battle_won_country = {
	#log = "[Root.GetName]: Triggered battle_won_country"

    if = {
        limit = {
            has_reform = wwu_idealism_glory
        }
        add_power_projection = {
            type = mission_rewards_power_projection
            amount = 5
        }
    }

	if = {
		limit = {
			FROM = { tag = REB }
		}
		change_variable = {
			which = rebels_suppressed
			value = 1
		}
	}
    
    if = {
        limit = {
            OR = {
                has_reform = scourge_reform
                has_reform = scourge_domain_reform
            }
        }
        set_country_flag = scourge_can_raise_dead
    }
}

# country
# root = loser country, from = winner country
on_battle_lost_country = {
	#log = "[Root.GetName]: Triggered battle_lost_country"
	battle_cult_spreading_effect = yes
    
	events = {
        rise_of_the_horde.6
    }
	random_events = {
		12 = 0
		2 = friendship_events.1 #Historical Friendship Broken
	}
	
}

# province
# root = location, from = loser country
on_battle_won_province = {
	#log = "[Root.GetName]: Triggered battle_won_province"

    
}

#Unit Scope OnAction for Battle Won
on_battle_won_unit = {
	#log = "[Root.GetName]: Triggered battle_won_unit"
	if = {
		limit = {
			unit_owner = { ai = no } #Scopes to Unit Owner from Unit Scope
			general_with_steam_name = yes #Unit Scope Trigger
		}
		unit_owner = { set_country_flag = general_with_steam_name_won_battle }
	}
}

# #Unit Scope OnAction for Battle Lost
on_battle_lost_unit = {
	#log = "[Root.GetName]: Triggered battle_lost_unit"
}

# province
# root = location, from = country doing it
on_added_to_trade_company ={

}

# province
# root = location, from = country doing it
on_removed_from_company ={

}

# province
# root = location, from = country doing it
on_company_formed ={

}

# province
# root = location, from = country doing it
on_company_disolved = {

}

# province
# root = location, from = winner country
on_battle_lost_province = {
	#log = "[Root.GetName]: Triggered battle_lost_province"
}

# country
# root = winning country, from = location
on_siege_won_country = {
	#log = "[Root.GetName]: Triggered siege_won_country"
    
    if = {
        limit = {
            has_government_attribute = enables_automatic_conversion
        }
        random = {
            chance = 33
            
            FROM = { change_religion = ROOT }
        }
    }
    
    # Ransom Captives 
    if = {
        limit = {
            has_government_attribute = enables_ransom_captives_event
        }
        random = {
            chance = 10
            
            country_event = { id = wwu_tribal.1 }
        }
    }
    
    # Enslave Captives 
    if = {
        limit = {
            has_government_attribute = enables_enslave_captives_event
        }
        random = {
            chance = 10
            
            country_event = { id = wwu_tribal.2 }
        }
    }
    
    # Integrate Captives 
    if = {
        limit = {
            has_government_attribute = enables_integrate_captives_event
        }
        random = {
            chance = 10
            
            country_event = { id = wwu_tribal.3 }
        }
    }
    
    # Execute Captives 
    if = {
        limit = {
            has_government_attribute = enables_execute_captives_event
        }
        random = {
            chance = 10
            
            country_event = { id = wwu_tribal.4 }
        }
    }
    
    # Conscript Captives 
    if = {
        limit = {
            has_government_attribute = enables_conscript_captives_event
        }
        random = {
            chance = 10
            
            country_event = { id = wwu_tribal.5 }
        }
    }
    
    random_events = {
		10 = army_professionalism_events.1 # City Sacked
		100 = 0
	}
}

# country
# root = losing country, from = location
on_siege_lost_country = {
	#log = "[Root.GetName]: Triggered siege_lost_country"
}

# province
# root = location, from = losing country
on_siege_won_province = {
	#log = "[Root.GetName]: Triggered siege_won_province"
}

# province
# root = location, from = winning country
on_siege_lost_province =  {
}

# province
# root = location, from = country that abandons colony
# Fired right before the colony is abandoned.
on_abandon_colony = {
	#log = "[Root.GetName]: Triggered abandon_colony"
}

# province
# root = location, from = country that owns it
# Fired right after the great project is constructed
on_great_project_constructed = {

}

# OBS: Consider that the following on_actions can be called for Personal Union juniors as well.
# country
on_new_monarch = {
	#log = "[Root.GetName]: Triggered new_monarch"
    reset_spellcaster_skills = yes
    
    # Add the Spellcaster mechanic automatically for these monarchs
    if = {
        limit = {
            OR = {
                has_reform = magocracy_reform
                has_reform = kingdom_of_magic_reform
            }
        }
        add_ruler_personality = spellcaster_personality
    
        random_list = {
            33 = {
                set_variable = {
                    which = ruler_magic_aptitude
                    value = 5
                }
            }
            33 = {
                set_variable = {
                    which = ruler_magic_aptitude
                    value = 10
                }
            }
            33 = {
                set_variable = {
                    which = ruler_magic_aptitude
                    value = 15
                }
            }
        }
        random_list = {
            33 = {
                set_variable = {
                    which = ruler_magic_finesse
                    value = 5
                }
            }
            33 = {
                set_variable = {
                    which = ruler_magic_finesse
                    value = 10
                }
            }
            33 = {
                set_variable = {
                    which = ruler_magic_finesse
                    value = 15
                }
            }
        }
        random_list = {
            33 = {
                set_variable = {
                    which = ruler_magic_concentration
                    value = 5
                }
            }
            33 = {
                set_variable = {
                    which = ruler_magic_concentration
                    value = 10
                }
            }
            33 = {
                set_variable = {
                    which = ruler_magic_concentration
                    value = 15
                }
            }
        }
    }
    
    #---------------
    # Consort
    #---------------
	if = {
		limit = {
			has_consort_regency = no
			any_owned_province = {
				has_province_modifier = domain_of_spouses_family
			}
		}
		random_owned_province = {
			limit = { has_province_modifier = domain_of_spouses_family }
			remove_province_modifier = domain_of_spouses_family
		}
	}
	if = {
		limit = {
			has_consort_regency = no
			any_owned_province = {
				has_province_modifier = home_of_consort
			}
		}
		random_owned_province = {
			limit = { has_province_modifier = home_of_consort }
			remove_province_modifier = home_of_consort
		}
	}
    
    events = {
        wwu_ruler_education.1    # The Education of [Root.Monarch.GetName]
        wwu_ruler_education.2    # Ascension of [Root.Monarch.GetName]
		wwu_dynastic.19
		wwu_pretender.1
        wwu_dragon_aspects.3
        wwu_dragon_aspects.5
        wwu_government.8         # Court Disposition
    }
	random_events = {
		1000 = 0
		50 = wwu_dynastic.30
		250 = wwu_pretender.1
	}
	
}

on_new_consort = {
	#log = "[Root.GetName]: Triggered new_consort"
	country_event = { id = wwu_consort.2 }
	
	if = {
		limit = { has_ruler_flag = had_10_years_anniversary }
		clr_ruler_flag = had_10_years_anniversary
	}
	if = {
		limit = { has_ruler_flag = had_20_years_anniversary }
		clr_ruler_flag = had_20_years_anniversary
	}
	if = {
		limit = { has_ruler_flag = consort_had_affection_of_ruler }
		clr_ruler_flag = consort_had_affection_of_ruler
	}
}

# country
on_monarch_death = {
	#log = "[Root.GetName]: Triggered monarch_death"
    
    if = {
        limit = {
            has_reform = wwu_assembly_absolute_rule
        }
        
        add_stability = -1
    }
    
    if = {
        limit = {
            has_government_attribute = enables_tribal_vote
        }
        
        country_event = { id = wwu_government.15 } # Tribal Vote
    }
    
    if = {
        limit = {
            has_country_modifier = head_of_old_horde
        }
        
        country_event = { id = wwu_faction_system.20 }
    }
    
    if = {
        limit = {
            has_country_modifier = head_of_horde
        }
        
        country_event = { id = wwu_faction_system.21 }
    }
    
	events = {
		loa.2 # Remove old loa's influence
        wwu_shamanism.1 # Passing of Great Leader
        wwu_government.11 # Gavelkind Succession
	}
    
    random_events = {
        100 = wwu_government.12 # Puppet Ruler
        
        200 = 0
    }
	
}

# country
on_regent = {
	#log = "[Root.GetName]: Triggered regent"
	events = {
		tribal_succession.1	# harsh anti-tribals.
	}
}

# country
on_extend_regency = {
	add_legitimacy = -10
}

# country
on_new_term_election = {
	#log = "[Root.GetName]: Triggered new_term_election"
	events = {
		wwu_government.2    # On Term Election
	}
}

# country
on_death_election = {
	#log = "[Root.GetName]: Triggered death_election"
	if = {
		limit = {
			government = pirate
		}
		set_country_flag = pirate_death_election
		country_event = { id = pirates.1 }
	}
	events = {
		wwu_government.1    # On Death Election
        wwu_government.5    # Lottery Election
	}
}

# country
on_death_foreign_slave_ruler = {
	#log = "[Root.GetName]: Triggered death_foreign_slave_ruler"
	events = {
		wwu_government.7 # New Rulership
	}
}

# country
on_replace_governor = {
	#log = "[Root.GetName]: Triggered replace_governor"
	events = {
		wwu_government.3    # On Replace Governor
	}
}


# country
on_bankruptcy = {
	#log = "[Root.GetName]: Triggered bankruptcy"
}

# country (country annexing, root = target)
on_diplomatic_annex = {
	#log = "[Root.GetName]: Triggered diplomatic_annex"
	events = {
		wwu_integration.1
	}
	change_variable = {
		which = diplo_annexed_nation
		value = 1
	}
}

# country
on_heir_death = {
	#log = "[Root.GetName]: Triggered heir_death"
	if = {
		limit = { has_country_flag = heir_dip_education }
		clr_ruler_flag = heir_dip_education
	}
	if = {
		limit = { has_country_flag = heir_mil_education }
		clr_ruler_flag = heir_mil_education
	}
	if = {
		limit = { has_country_flag = heir_adm_education }
		clr_ruler_flag = heir_adm_education
	}
	if = {
		limit = { has_ruler_flag = well_advised_tutored_heir }
		clr_ruler_flag = well_advised_tutored_heir
	}
	if = {
		limit = { has_ruler_flag = heir_went_on_grand_tour }
		clr_ruler_flag = heir_went_on_grand_tour
	}
	if = {
		limit = { has_country_flag = albrecht_achilles_flag }
		clr_country_flag = albrecht_achilles_flag #Death of original Albrecht Achilles
	}
	if = {
		limit = { has_ruler_flag = sancaga_cikma }
		clr_ruler_flag = sancaga_cikma
		every_owned_province = {
			limit = {
				has_province_modifier = heir_in_training
			}
			remove_province_modifier = heir_in_training
		}
	}
	if = {
		limit = { has_ruler_flag = returned_from_sancaga_sikma_province }
		clr_ruler_flag = returned_from_sancaga_sikma_province
	}
    
    events = {
        wwu_government.10 # Heir Apparent
    }
}

# country
on_queen_death = {
	#log = "[Root.GetName]: Triggered queen_death"

	if = {
		limit = { has_consort_flag = 10_years_anniversary }
		set_ruler_flag = had_10_years_anniversary
	}
	if = {
		limit = { has_consort_flag = 20_years_anniversary }
		set_ruler_flag = had_20_years_anniversary
	}
	if = {
		limit = { has_consort_flag = consort_has_affection_of_ruler }
		set_ruler_flag = consort_had_affection_of_ruler
	}

	if = {
		limit = {
			has_regency = no
			NOT = { has_ruler_flag = widow_widower }
		}
		set_ruler_flag = widow_widower
	}
	if = {
		limit = { has_consort_regency = no }
		random_owned_province = {
			limit = { has_province_modifier = domain_of_spouses_family }
			remove_province_modifier = domain_of_spouses_family
		}
	}
	if = {
		limit = { has_ruler_flag = accepted_help_from_spouses_family }
		clr_ruler_flag = accepted_help_from_spouses_family
	}
	if = {
		limit = { has_ruler_flag = helped_spouses_family }
		clr_ruler_flag = helped_spouses_family
	}
	if = {
		limit = { has_ruler_flag = refused_to_help_spouses_family }
		clr_ruler_flag = refused_to_help_spouses_family
	}
	if = {
		limit = { has_ruler_flag = lowborn_consort }
		random_owned_province = {
			limit = { has_province_modifier = home_of_consort }
			remove_province_modifier = home_of_consort
		}
	}
	if = {
		limit = { has_ruler_flag = lowborn_consort }
		clr_ruler_flag = lowborn_consort
	}
	if = {
		limit = { has_country_modifier = consort_adm_advice }
		remove_country_modifier = consort_adm_advice
	}
	if = {
		limit = { has_country_modifier = consort_dip_advice }
		remove_country_modifier = consort_dip_advice
	}
	if = {
		limit = { has_country_modifier = consort_mil_advice }
		remove_country_modifier = consort_mil_advice
	}
	if = {
		limit = { has_country_modifier = without_spouse_advice }
		remove_country_modifier = without_spouse_advice
	}
	if = {
		limit = { has_ruler_modifier = affectionate_royal_couple }
		remove_country_modifier = affectionate_royal_couple
	}
	clr_ruler_flag = marriage_length
}

# country
on_new_heir = {
	#log = "[Root.GetName]: Triggered new_heir"
}

# country
on_weak_heir_claim = {
	#log = "[Root.GetName]: Triggered weak_heir_claim"
	events = {
				# Pretenders rise up
	}
}

# country : no heir in theocracy
on_heir_needed_theocracy = {
	#log = "[Root.GetName]: Triggered heir_needed_theocracy"
	events = {
		wwu_theocracy.1
	}
}

# Emperor from same dynasty
on_successive_emperor = {
	#log = "[Root.GetName]: Triggered successive_emperor"
    
    emperor = {
        add_imperial_influence = 5
    }
}

on_emperor_elected = {
	#log = "[Root.GetName]: Triggered emperor_elected"
	every_elector = {
		if = {
			limit = {
				preferred_emperor = root
			}
			change_variable = {
				which = supported_successive_emperors
				value = 1
			}
		}
		else = {
			set_variable = {
				which = supported_successive_emperors
				value = 0
			}
		}
	}

	emperor = {
		save_global_event_target_as = Emperor
	}
	FROM = {
		if = {
			limit = { has_country_modifier = diet_occupied }
			remove_country_modifier = diet_occupied
			ROOT = {
				add_country_modifier = { name = diet_occupied duration = -1 }
			}
		}
		if = {
			limit = {
				any_country = {
					reverse_has_opinion_modifier = {
						modifier = opinion_imperial_diplomacy
						who = prev
					}
				}
			}
			every_country = {
				limit = {
					reverse_has_opinion_modifier = {
						modifier = opinion_imperial_diplomacy
						who = prev
					}
				}
				reverse_remove_opinion = {
					modifier = opinion_imperial_diplomacy
					who = prev
				}
				ROOT = {
					add_opinion = {
						modifier = opinion_imperial_diplomacy
						who = prev
					}
				}
			}
		}
	}
}

# HRE Prince released by the emperor
on_released_hre_member = {
	#log = "[Root.GetName]: Triggered released_hre_member"
    
    emperor = {
        add_imperial_influence = 10
    }
}

# HRE Prince converts to non-Emperor religion
on_hre_member_false_religion = {
	#log = "[Root.GetName]: Triggered hre_member_false_religion"
}

# HRE Prince converts to Emperor religion
on_hre_member_true_religion = {
	#log = "[Root.GetName]: Triggered hre_member_true_religion"
}

# Emperor wins HRE defensive war
on_hre_wins_defensive_war = {
	#log = "[Root.GetName]: Triggered hre_wins_defensive_war"
    
    emperor = {
        add_imperial_influence = 10
    }
}

# HRE member annexed by non-HRE country
on_hre_member_annexed = {
	#log = "[Root.GetName]: Triggered hre_member_annexed"
    
    emperor = {
        add_imperial_influence = -10
    }
}

# HRE member released from non-HRE vassalage
on_hre_released_vassal = {
	#log = "[Root.GetName]: Triggered hre_released_vassal"
}

# HRE member transferred from non-HRE vassalage to Emperor
on_hre_transfered_vassal = {
	#log = "[Root.GetName]: Triggered hre_transfered_vassal"
}

# Emperor coming to the defense of a HRE member
on_hre_defense = {
	#log = "[Root.GetName]: Triggered hre_defense"
    
    emperor = {
        add_imperial_influence = 5
    }
}

# Emperor NOT coming to the defense of a HRE member
on_hre_non_defense = {
	#log = "[Root.GetName]: Triggered hre_non_defense"
    
    emperor = {
        add_imperial_influence = -10
    }
}

# HRE Member takes a HRE province from an outs100e country in a peace (province scope)
on_hre_province_reconquest = {
	#log = "[Root.GetName]: Triggered hre_province_reconquest"
}

on_lock_hre_religion = {
	#log = "[Root.GetName]: Triggered lock_hre_religion"
}

on_change_hre_religion = {
	#log = "[Root.GetName]: Triggered change_hre_religion"
}

on_hre_religion_white_peace = {
	#log = "[Root.GetName]: Triggered hre_religion_white_peace"
}

# When a non-native changes government type
on_government_change = {
	#log = "[Root.GetName]: Triggered government_change"
	if = {
		limit = {
			NOT = { government = monarchy }
			any_owned_province = {
				has_province_modifier = domain_of_spouses_family
			}
		}
		random_owned_province = {
			limit = { has_province_modifier = domain_of_spouses_family }
			remove_province_modifier = domain_of_spouses_family
		}
	}
	if = {
		limit = {
			NOT = { government = monarchy }
			any_owned_province = {
				has_province_modifier = home_of_consort
			}
		}
		random_owned_province = {
			limit = { has_province_modifier = home_of_consort }
			remove_province_modifier = home_of_consort
		}
	}
}

# When a native changes government after filling all their advancement groups.
on_native_change_government = {
	#log = "[Root.GetName]: Triggered native_change_government"
}

# Nation is integrated after being in union
on_integrate = {
	#log = "[Root.GetName]: Triggered integrate"
	events = {
		wwu_integration.1
	}
}

# Nation annexed.
# FROM is the nation being annexed
on_annexed = {
	#log = "[Root.GetName]: Triggered annexed"
    on_annexed_estate_privileges_effect = yes
    
	events = {
        wwu_dragon_aspects.30
        wwu_dragon_aspects.31
	}
	change_variable = {
		which = annexed_nation
		value = 1
	}
}

# When the chinese empire gets dismantled (e.g. when the emperor is annexed)
# FROM = Emperor, ROOT = Current Nation
on_chinese_empire_dismantled = {
	#log = "[Root.GetName]: Triggered chinese_empire_dismantled"
	clear_global_event_target = celestial_emperor
	events = {

	}
}

# When a nation gains the Mandate of Heaven (becomes the Emperor of China)
# FROM = Old Emperor, ROOT = New Emperor
on_mandate_of_heaven_gained = {
	#log = "[Root.GetName]: Triggered mandate_of_heaven_gained"
	save_global_event_target_as = celestial_emperor
    
	set_mandate = 60
	set_meritocracy = 60
    add_country_modifier = {
		name = new_leader_of_the_aspects
		duration = 9125
	}
    if = {
		limit = {
			has_country_modifier = lost_mandate_of_heaven
		}
		remove_country_modifier = lost_mandate_of_heaven
	}
    country_event = {
		id = wwu_dragon_aspects.31
		days = 365
	}
}

# When a nation loses the Mandate of Heaven
# FROM = New Emperor, ROOT = Old Emperor
on_mandate_of_heaven_lost = {
	#log = "[Root.GetName]: Triggered mandate_of_heaven_lost"
    
	add_country_modifier = {
		name = lost_mandate_of_heaven
		duration = 7300
	}
    
    add_stability = -2
    
    if = {
		limit = {
			has_country_modifier = new_leader_of_the_aspects
		}
		remove_country_modifier = new_leader_of_the_aspects
	}
}

on_embrace_revolution = {
	
}

on_dismantle_revolution = {
	#log = "[Root.GetName]: Triggered dismantle_revolution"
	
}

# province
on_adm_development = {
	#log = "[Root.GetName]: Triggered adm_development"
}

# province
on_dip_development = {
	#log = "[Root.GetName]: Triggered dip_development"
}

# province
on_mil_development = {
	#log = "[Root.GetName]: Triggered mil_development"
}

on_overextension_pulse = {
	#log = "[Root.GetName]: Triggered overextension_pulse"
	random_events = {
		100 = overextension.1
		100 = overextension.2
		100 = overextension.3
		100 = overextension.4
		100 = overextension.5
		100 = overextension.6
		100 = overextension.7
		100 = overextension.8
		100 = overextension.9
		100 = overextension.10
	}
}


on_colonial_pulse = {
	#log = "[Root.GetName]: Triggered colonial_pulse"
}

on_siberian_pulse = {
	#log = "[Root.GetName]: Triggered siberian_pulse"
}


# country random events
on_bi_yearly_pulse = {
	#log = "[Root.GetName]: Triggered bi_yearly_pulse"
	
	swap_non_generic_missions = yes # Update missions
    
    # Flag Update
    clr_country_flag = scourge_can_raise_dead
    
    # Events
	random_events = {
		#Streltsy Events
		125 = streltsy_events.1
		125 = streltsy_events.3
		125 = streltsy_events.4
		125 = streltsy_events.5
		# Trade Specific
		100 = trade.1
		100 = trade.2
		100 = trade.3
		100 = trade.4
		100 = trade.5
		100 = trade.6
		100 = trade.7
		100 = trade.8
		100 = trade.9
		100 = trade.10
		100 = trade.11
		100 = trade.12
		# Trade League Events
		100 = trade_league.1
		100 = trade_league.2
		100 = trade_league.3
		100 = trade_league.4
		100 = trade_league.7
		100 = trade_league.8
		100 = trade_league.9
		100 = trade_league.10
		100 = trade_league.11
		100 = trade_league.12
		100 = trade_league.13

		# Refoms, when having parliaments.
		100 = reforms.1
		100 = reforms.2
		100 = reforms.3
		100 = reforms.4

        # Tribes
		100 = wwu_tribes.1
		100 = wwu_tribes.2
		100 = wwu_tribes.3
		100 = wwu_tribes.4
		100 = wwu_tribes.5
		100 = wwu_tribes.6
		100 = wwu_tribes.7
		100 = wwu_tribes.8
		100 = wwu_tribes.9
        100 = wwu_tribes.10
        100 = wwu_tribes.11
        100 = wwu_tribes.12
		100 = wwu_tribes.13
		100 = wwu_tribes.14
        100 = wwu_tribes.15
        100 = wwu_tribes.16
		100 = wwu_tribes.17
		100 = wwu_tribes.19
		100 = wwu_tribes.20
		100 = wwu_tribes.21
		100 = wwu_tribes.22
		100 = wwu_tribes.23
		100 = wwu_tribes.24
        
		# Sailor events
		100 = sailor_event.1
		100 = sailor_event.2
		100 = sailor_event.3
		100 = sailor_event.4
		100 = sailor_event.5

		# Corruption Events
		100 = wwu_corruption.16
		100 = wwu_corruption.17
		100 = wwu_corruption.18
		100 = wwu_corruption.19
		100 = wwu_corruption.20

        # Arcane
        150 = wwu_arcane.2
        150 = wwu_arcane.3
        150 = wwu_arcane.4

		# Minority Expulsion Events
		100 = expel_minority_events.1
		100 = expel_minority_events.2
		100 = expel_minority_events.3
		100 = expel_minority_events.4
		100 = expel_minority_events.5

		1250 = 0
	}
}

on_bi_yearly_pulse_2 = {
	#log = "[Root.GetName]: Triggered bi_yearly_pulse_2"
	random_events = {
		100 = wwu_corruption.1
		100 = wwu_corruption.2
		100 = wwu_corruption.3
		100 = wwu_corruption.4
		100 = wwu_corruption.5
		100 = wwu_corruption.6
		100 = wwu_corruption.7
		100 = wwu_corruption.8
		100 = wwu_corruption.9
		100 = wwu_corruption.10
		200 = wwu_corruption.11
		200 = wwu_corruption.12
		200 = wwu_corruption.13
		200 = wwu_corruption.14
		200 = wwu_corruption.15
        
        # Fel
        100 = wwu_fel.10
        100 = wwu_fel.11
        100 = wwu_fel.12
        100 = wwu_fel.13
        
        # Fel - Legion Strength 100%
        200 = wwu_fel.20
        200 = wwu_fel.21
        
        # Elemental Attunement
        400 = wwu_elemental_attunement.10
        50 = wwu_elemental_attunement.11
        50 = wwu_elemental_attunement.12
        
		4000 = 0
	}
}

on_bi_yearly_pulse_3 = {
	#log = "[Root.GetName]: Triggered bi_yearly_pulse_3"
	
    #-----------------------
    # Magic Events
    #-----------------------
    events = {
        wwu_magic.11 # Accomplished Spellcaster
    }
    random_events = {
        # Magic Training
        100 = wwu_magic.1
        50 = wwu_magic.2
        50 = wwu_magic.3
        50 = wwu_magic.4
        100 = wwu_magic.5
        100 = wwu_magic.6
        100 = wwu_magic.7
        100 = wwu_magic.8
        100 = wwu_magic.9
        100 = wwu_magic.10
        
        1000 = 0
    }
}

on_bi_yearly_pulse_4 = {
	#log = "[Root.GetName]: Triggered bi_yearly_pulse_4"
    
    random_events = {
        # Espionage
		100 = espionage_events.1
		10 = espionage_events.6
		100 = espionage_events.8
		80 = espionage_events.9
        
        # Minority Expulsion Events
		100 = expel_minority_events.1
		100 = expel_minority_events.2
		100 = expel_minority_events.3
		100 = expel_minority_events.4
		100 = expel_minority_events.5
        
        # Innovativeness
		100 = innovativeness_events.4
		100 = innovativeness_events.5
		100 = innovativeness_events.6
		100 = innovativeness_events.7
		100 = innovativeness_events.8
		100 = innovativeness_events.9
		100 = innovativeness_events.10
		100 = innovativeness_events.13
		100 = innovativeness_events.15
        
        # Mercenaries
		100 = mercs.2
		100 = mercs.3
		100 = mercs.4
		100 = mercs.7
		100 = mercs.11
        
        # Professionalism
		100 = army_professionalism_events.4
		100 = army_professionalism_events.5
		75 = army_professionalism_events.6
		100 = army_professionalism_events.8
		100 = army_professionalism_events.9
		100 = army_professionalism_events.10
		100 = army_professionalism_events.11
		75 = army_professionalism_events.12
		100 = army_professionalism_events.13
		75 = army_professionalism_events.16

        # Estate Agenda
		1000 = estate_system.1

		2000 = 0
    }
}

on_bi_yearly_pulse_5 = {
    
}

# country random events
on_thri_yearly_pulse = {
	#log = "[Root.GetName]: Triggered thri_yearly_pulse"
    
	random_events = {
		# Republics
		100 = republics.4
		100 = republics.5
		100 = republics.6
		100 = republics.7
		100 = republics.8
		100 = republics.9
		100 = republics.10
		100 = republics.11
		100 = republics.12
		100 = republics.13
		100 = republics.14
		100 = republics.15
		100 = republics.16
		100 = republics.17
		100 = republics.18
		100 = republics.19
		100 = republics.20
		100 = republics.21
		100 = republics.22
		100 = republics.23
		100 = republics.24
		100 = republics.25
		100 = republics.26
		100 = republics.27
		100 = republics.28
		100 = republics.29
		100 = republics.30
		100 = republics.31
		100 = republics.32
		100 = republics.33
		100 = republics.34
		100 = republics.35
		100 = republics.36
		100 = republics.37
		100 = republics.38
		100 = republics.39
		100 = republics.40
		100 = republics.41
		100 = republics.42
		100 = republics.43

		# China
		75 = meritocracy_events.1
		75 = meritocracy_events.2
		75 = meritocracy_events.3
		75 = meritocracy_events.4
		75 = meritocracy_events.5
		
		# Random Events
		100 = wwu_random_events.1
		100 = wwu_random_events.2
		100 = wwu_random_events.3
		100 = wwu_random_events.4
		100 = wwu_random_events.5
		100 = wwu_random_events.6
		100 = wwu_random_events.7
		100 = wwu_random_events.8
		100 = wwu_random_events.9
		100 = wwu_random_events.10
		100 = wwu_random_events.11
		100 = wwu_random_events.12
		100 = wwu_random_events.13
		100 = wwu_random_events.14
		100 = wwu_random_events.15
		100 = wwu_random_events.16
		100 = wwu_random_events.17
		100 = wwu_random_events.18
		100 = wwu_random_events.19
		100 = wwu_random_events.20
		100 = wwu_random_events.21
		100 = wwu_random_events.22
		100 = wwu_random_events.23
		100 = wwu_random_events.24
		100 = wwu_random_events.25
		100 = wwu_random_events.26
		100 = wwu_random_events.27
		100 = wwu_random_events.28
		100 = wwu_random_events.29
		100 = wwu_random_events.30
		100 = wwu_random_events.31
		100 = wwu_random_events.32
		100 = wwu_random_events.33
		100 = wwu_random_events.34
		100 = wwu_random_events.35
		100 = wwu_random_events.36
		100 = wwu_random_events.37
		100 = wwu_random_events.38
		100 = wwu_random_events.39
		100 = wwu_random_events.40
		100 = wwu_random_events.41
		100 = wwu_random_events.42
		100 = wwu_random_events.43
		100 = wwu_random_events.44
		100 = wwu_random_events.45
		100 = wwu_random_events.46
		100 = wwu_random_events.47
		100 = wwu_random_events.48
		100 = wwu_random_events.49
		100 = wwu_random_events.50
		100 = wwu_random_events.51
		100 = wwu_random_events.52
		100 = wwu_random_events.53
		100 = wwu_random_events.54
		100 = wwu_random_events.55
		100 = wwu_random_events.56
		100 = wwu_random_events.57
		100 = wwu_random_events.58
		100 = wwu_random_events.59
		100 = wwu_random_events.60
		100 = wwu_random_events.61
		100 = wwu_random_events.62
		100 = wwu_random_events.63
		100 = wwu_random_events.64
		100 = wwu_random_events.65
		100 = wwu_random_events.66
		100 = wwu_random_events.67

		
		1000 = 0
	}
}

on_thri_yearly_pulse_2 = {
	#log = "[Root.GetName]: Triggered thri_yearly_pulse_2"
}

on_thri_yearly_pulse_3 = {
	#log = "[Root.GetName]: Triggered thri_yearly_pulse_3"
	random_events = {
		# Subject Interactions
		50 = subject_interaction_events.1
		50 = subject_interaction_events.4
		50 = subject_interaction_events.5
		50 = subject_interaction_events.6
		50 = subject_interaction_events.7
		50 = subject_interaction_events.9
		50 = subject_interaction_events.11
		50 = subject_interaction_events.14
		50 = subject_interaction_events.15
		50 = subject_interaction_events.17
		50 = subject_interaction_events.18
		50 = subject_interaction_events.19
		50 = subject_interaction_events.20
		50 = subject_interaction_events.21
		50 = subject_interaction_events.22
		50 = subject_interaction_events.23
		50 = subject_interaction_events.24
		50 = subject_interaction_events.25
		50 = subject_interaction_events.26
		50 = subject_interaction_events.27
		50 = subject_interaction_events.29
		50 = subject_interaction_events.30
		50 = subject_interaction_events.31
		50 = subject_interaction_events.32
		50 = subject_interaction_events.34
		50 = subject_interaction_events.35
		50 = subject_interaction_events.36
		50 = subject_interaction_events.38
		50 = subject_interaction_events.40
		50 = subject_interaction_events.43
		75 = tributary_events.1
		75 = tributary_events.2
		75 = tributary_events.3
		75 = tributary_events.4
		75 = tributary_events.5
		75 = tributary_events.6
		75 = tributary_events.7
		75 = tributary_events.8
		75 = tributary_events.9
		75 = tributary_events.10
		75 = tributary_events.13
		75 = tributary_events.16
		75 = tributary_events.17
		75 = tributary_events.18
		75 = tributary_events.19
		75 = tributary_events.23
		75 = tributary_events.24
		75 = tributary_events.26
		75 = tributary_events.25
		75 = tributary_events.27

		1000 = 0
	}
}

on_thri_yearly_pulse_4 = {
	#log = "[Root.GetName]: Triggered thri_yearly_pulse_4"
}

on_four_year_pulse = {
	#log = "[Root.GetName]: Triggered four_year_pulse"
	random_events = {
		# Colonial Nations
		100 = colonial_nation.1
		100 = colonial_nation.4
		100 = colonial_nation.10
		100 = colonial_nation.12
		100 = colonial_nation.14
		100 = colonial_nation.77
		100 = colonial_nation.100
		100 = colonial_nation.102
		100 = colonial_nation.104
		100 = colonial_nation.106
		100 = colonial_nation.108
		100 = colonial_nation.110
		100 = colonial_nation.112
		100 = colonial_nation.114
		100 = colonial_nation.116
		100 = colonial_nation.118
		100 = colonial_nation.120
		100 = colonial_nation.122
		100 = colonial_nation.124
		100 = colonial_nation.126
		100 = colonial_nation.128
		100 = colonial_nation.130
		100 = colonial_nation.132
		100 = colonial_nation.134
		10 = colonial_nation.140
		10 = colonial_nation.142
		10 = colonial_nation.144
		10 = colonial_nation.146
		10 = colonial_nation.148
		10 = colonial_nation.150
		10 = colonial_nation.152
		10 = colonial_nation.154
		10 = colonial_nation.156
		10 = colonial_nation.158
		10 = colonial_nation.160
		10 = colonial_nation.162
		10 = colonial_nation.164
		10 = colonial_nation.166
		10 = colonial_nation.168
		10 = colonial_nation.170
		10 = colonial_nation.172
		10 = colonial_nation.174
		10 = colonial_nation.176

		# Republic Factions
		100 = republic_factions.2
		100 = republic_factions.5
		100 = republic_factions.7
		100 = republic_factions.9
		100 = republic_factions.10
		100 = republic_factions.12
		100 = republic_factions.13
		100 = republic_factions.14
		100 = republic_factions.15
		100 = republic_factions.16
		100 = republic_factions.17
		100 = republic_factions.18
		100 = republic_factions.19
		100 = republic_factions.20
		100 = republic_factions.22
		100 = republic_factions.23
		100 = republic_factions.24

		# Pirate Factions
		100 = pirates.10
		100 = pirates.11
		100 = pirates.12
		100 = pirates.13
		100 = pirates.14
		100 = pirates.15
		100 = pirates.16
		100 = pirates.17
		100 = pirates.18
		100 = pirates.19
        
        # Republican Dictatorship
		100 = republican_dictatorship.1
		100 = republican_dictatorship.2
		100 = republican_dictatorship.3
		100 = republican_dictatorship.4
		100 = republican_dictatorship.5
		100 = republican_dictatorship.6
		100 = republican_dictatorship.7
		100 = republican_dictatorship.8
        
        # Druidism
        100 = wwu_druidism.1
        100 = wwu_druidism.2
        100 = wwu_druidism.3
        
        # Celestials
        100 = wwu_celestials.1
        100 = wwu_celestials.2
        100 = wwu_celestials.3
        100 = wwu_celestials.4
        
        1000 = 0
	}
}

on_four_year_pulse_2 = {
	# Magic
    add_mana_1 = yes
    
    # Mana Regeneration sources
    if = {
        limit = {
            OR = {
                has_idea = dalaran_ideas_7
                has_idea = karazhan_ideas_4
                has_idea = blue_dragonflight_ideas_7
                has_idea = tortollan_ideas_5
            }
        }
        add_mana_1 = yes
    }
}

on_four_year_pulse_3 = {
	#log = "[Root.GetName]: Triggered four_year_pulse_3"
}

on_four_year_pulse_4 = {
	#log = "[Root.GetName]: Triggered four_year_pulse_4"
}

on_five_year_pulse = {
	#log = "[Root.GetName]: Triggered five_year_pulse"
    
    events = {
        wwu_government.14 # Organisational Focus
    }
    
    random_events = {

		# Aristocracy 		13  (8g 5b)
		100 = ideagroups.100
		100 = ideagroups.101
		100 = ideagroups.102
		100 = ideagroups.103
		100 = ideagroups.104
		100 = ideagroups.105
		100 = ideagroups.106
		100 = ideagroups.107
		100 = ideagroups.108
		100 = ideagroups.109
		100 = ideagroups.110
		100 = ideagroups.111
		100 = ideagroups.112


		# Plutocracy 		19 (12g 7b)
		100 = ideagroups.200
		100 = ideagroups.201
		100 = ideagroups.202
		100 = ideagroups.203
		100 = ideagroups.204
		100 = ideagroups.205
		100 = ideagroups.206
		100 = ideagroups.207
		100 = ideagroups.208
		100 = ideagroups.209
		100 = ideagroups.210
		100 = ideagroups.211
		100 = ideagroups.212
		100 = ideagroups.213
		100 = ideagroups.214
		100 = ideagroups.215
		100 = ideagroups.216
		100 = ideagroups.217
		100 = ideagroups.218

		# Innovativenes		11 (7g 4b)
		100 = ideagroups.300
		100 = ideagroups.301
		100 = ideagroups.302
		100 = ideagroups.303
		100 = ideagroups.304
		100 = ideagroups.305
		100 = ideagroups.307
		100 = ideagroups.308
		100 = ideagroups.309
		100 = ideagroups.310

		# Religious		18 (11g 7b)
		100 = ideagroups.400
		100 = ideagroups.401
		100 = ideagroups.402
		100 = ideagroups.403
		100 = ideagroups.404
		100 = ideagroups.405
		100 = ideagroups.407
		100 = ideagroups.408
		100 = ideagroups.409
		100 = ideagroups.411
		100 = ideagroups.412
		100 = ideagroups.413
		100 = ideagroups.414
		100 = ideagroups.415
		100 = ideagroups.416
		100 = ideagroups.417


		# Spy			9 (6g 3b)
		100 = ideagroups.500
		100 = ideagroups.501
		100 = ideagroups.502
		100 = ideagroups.503
		100 = ideagroups.504
		100 = ideagroups.505
		100 = ideagroups.506
		100 = ideagroups.507
		100 = ideagroups.508


		# Diplomatic		9 (6g 3b)
		100 = ideagroups.600
		100 = ideagroups.601
		100 = ideagroups.602
		100 = ideagroups.603
		100 = ideagroups.604
		100 = ideagroups.605
		100 = ideagroups.606
		100 = ideagroups.607
		100 = ideagroups.608


		# Offensive 		14 (9g 5b)
		100 = ideagroups.700
		100 = ideagroups.701
		100 = ideagroups.702
		100 = ideagroups.703
		100 = ideagroups.704
		100 = ideagroups.705
		100 = ideagroups.706
		100 = ideagroups.707
		100 = ideagroups.708
		100 = ideagroups.709
		100 = ideagroups.710
		100 = ideagroups.711
		100 = ideagroups.712
		100 = ideagroups.713


		# Defensive		11 (5g 6b)
		100 = ideagroups.800
		100 = ideagroups.801
		100 = ideagroups.802
		100 = ideagroups.803
		100 = ideagroups.804
		100 = ideagroups.805
		100 = ideagroups.806
		100 = ideagroups.807
		100 = ideagroups.808
		100 = ideagroups.809
		100 = ideagroups.810
		100 = ideagroups.811
		100 = ideagroups.812
		100 = ideagroups.813
		100 = ideagroups.814
		100 = ideagroups.815


		# Trade			6 (7g 4b)
		100 = ideagroups.900
		100 = ideagroups.901
		100 = ideagroups.902
		100 = ideagroups.903
		100 = ideagroups.904
		100 = ideagroups.905
		100 = ideagroups.906
		100 = ideagroups.907
		100 = ideagroups.908
		100 = ideagroups.909
		100 = ideagroups.910

		# Maritime			22 (14g 8b)
		100 = ideagroups.1000
		100 = ideagroups.1001
		100 = ideagroups.1002
		100 = ideagroups.1003
		100 = ideagroups.1004
		100 = ideagroups.1005
		100 = ideagroups.1006
		100 = ideagroups.1007
		100 = ideagroups.1008
		100 = ideagroups.1009
		100 = ideagroups.1010
		100 = ideagroups.1011
		100 = ideagroups.1012
		100 = ideagroups.1013
		100 = ideagroups.1014
		100 = ideagroups.1015
		100 = ideagroups.1016
		100 = ideagroups.1017
		100 = ideagroups.1018
		100 = ideagroups.1019
		100 = ideagroups.1020
		100 = ideagroups.1021

		# Economic		11 (7g 4b)
		100 = ideagroups.1100
		100 = ideagroups.1101
		100 = ideagroups.1102
		100 = ideagroups.1103
		100 = ideagroups.1104
		100 = ideagroups.1105
		100 = ideagroups.1106
		100 = ideagroups.1107
		100 = ideagroups.1108
		100 = ideagroups.1109
		100 = ideagroups.1110

		# Exploration		11 (7g 4b)
		100 = ideagroups.1200
		100 = ideagroups.1201
		100 = ideagroups.1202
		100 = ideagroups.1203
		100 = ideagroups.1204
		100 = ideagroups.1205
		100 = ideagroups.1206
		100 = ideagroups.1209
		100 = ideagroups.1210

		# Quality		11 (7g 4b)
		100 = ideagroups.1300
		100 = ideagroups.1301
		100 = ideagroups.1302
		100 = ideagroups.1303
		100 = ideagroups.1304
		100 = ideagroups.1305
		100 = ideagroups.1306
		100 = ideagroups.1307
		100 = ideagroups.1308
		100 = ideagroups.1309
		100 = ideagroups.1310

		# Quantity		11 (7g 4b)
		100 = ideagroups.1400
		100 = ideagroups.1401
		100 = ideagroups.1402
		100 = ideagroups.1403
		100 = ideagroups.1404
		100 = ideagroups.1405
		100 = ideagroups.1406
		100 = ideagroups.1407
		100 = ideagroups.1408
		100 = ideagroups.1409
		100 = ideagroups.1410


		# Expansion		11 (7g 4b)
		100 = ideagroups.1500
		100 = ideagroups.1501
		100 = ideagroups.1502
		100 = ideagroups.1503
		100 = ideagroups.1504
		100 = ideagroups.1505
		100 = ideagroups.1506
		100 = ideagroups.1507
		100 = ideagroups.1508
		100 = ideagroups.1509
		100 = ideagroups.1510

		# Administrative	3 (1g 2b)
		100 = ideagroups.1600
		100 = ideagroups.1601
		100 = ideagroups.1602
		100 = ideagroups.1603
		100 = ideagroups.1604
		100 = ideagroups.1605
		100 = ideagroups.1606
		100 = ideagroups.1607
		100 = ideagroups.1608
		100 = ideagroups.1609
		100 = ideagroups.1610

		# Naval		11 (7g 4b)
		100 = ideagroups.1700
		100 = ideagroups.1701
		100 = ideagroups.1702
		100 = ideagroups.1703
		100 = ideagroups.1704
		100 = ideagroups.1705
		100 = ideagroups.1706
		100 = ideagroups.1707
		100 = ideagroups.1708
		100 = ideagroups.1709
		100 = ideagroups.1710

		# Influence		11 (7g 4b)
		100 = ideagroups.1800
		100 = ideagroups.1801
		100 = ideagroups.1802
		100 = ideagroups.1803
		100 = ideagroups.1804
		100 = ideagroups.1805
		100 = ideagroups.1806
		100 = ideagroups.1807
		100 = ideagroups.1808
		100 = ideagroups.1809
		100 = ideagroups.1810

		# Humanist		11 (7g 4b)
		100 = ideagroups.1900
		100 = ideagroups.1901
		100 = ideagroups.1902
		100 = ideagroups.1903
		100 = ideagroups.1904
		100 = ideagroups.1905
		100 = ideagroups.1906
		100 = ideagroups.1907
		100 = ideagroups.1908
		100 = ideagroups.1909
		100 = ideagroups.1910
        
        500 = wwu_dragon_aspects.10
        500 = wwu_dragon_aspects.11
        500 = wwu_dragon_aspects.12

		1000 = 0
	}
}

on_five_year_pulse_2 = {
    #log = "[Root.GetName]: Triggered five_year_pulse_2"
    random_events = {
        50 = wwu_ruler.1 # Immortal - Stat Gain
        50 = wwu_ruler.2 # Immortal - Stat Loss
        
        100 = wwu_pirate_ruler_death.1
        100 = wwu_pirate_ruler_death.2
        100 = wwu_pirate_ruler_death.3
        
        1000 = 0
    }
}

on_five_year_pulse_3 = {
	#log = "[Root.GetName]: Triggered five_year_pulse_3"
	random_events = {
        # Emerald Dream
        100 = wwu_emerald_dream.1
        100 = wwu_emerald_dream.2
        100 = wwu_emerald_dream.3
        100 = wwu_emerald_dream.4
        100 = wwu_emerald_dream.6
        100 = wwu_emerald_dream.7
        100 = wwu_emerald_dream.8
    
		# 100 = propagate_religion_events.1
		# 100 = propagate_religion_events.2
		# 100 = propagate_religion_events.3
		# 100 = propagate_religion_events.4
		# 100 = propagate_religion_events.5
		# 100 = propagate_religion_events.6
		# 100 = propagate_religion_events.8
		# 100 = propagate_religion_events.9
		# 100 = propagate_religion_events.10
		#100 = propagate_religion_events.11 #Province event
        
        100 = wwu_naga.1
        100 = wwu_naga.2
        100 = wwu_naga.3
        
        100 = wwu_government.9 # Decadence
        100 = wwu_government.10 # Heir Apparent
        
		1000 = 0
	}
}

on_five_year_pulse_4 = {
	#log = "[Root.GetName]: Triggered five_year_pulse_4"
    #fail-safe if for whatever reason these flags stay after being used in events
	if = {
		limit = {
			had_country_flag = {
				flag = advisor_events_adm
				days = 720
			}
		}
		clr_country_flag = advisor_events_adm
	}
	if = {
		limit = {
			had_country_flag = {
				flag = advisor_events_dip
				days = 720
			}
		}
		clr_country_flag = advisor_events_dip
	}
	if = {
		limit = {
			had_country_flag = {
				flag = advisor_events_mil
				days = 720
			}
		}
		clr_country_flag = advisor_events_mil
	}
}

# El Dorado
on_explore_coast = {
	#log = "[Root.GetName]: Triggered explore_coast"
}
on_conquistador_empty = {
	#log = "[Root.GetName]: Triggered conquistador_empty"
}

on_conquistador_native = {
	#log = "[Root.GetName]: Triggered conquistador_native"
}

on_buy_religious_reform = {
	#log = "[Root.GetName]: Triggered buy_religious_reform"
}

on_circumnavigation = {
	#log = "[Root.GetName]: Triggered circumnavigation"
    events = {
		wwu_exploration.1 # Initial Circumnavigation
        wwu_exploration.2 # Repeat Circumnavigation
    }
}

on_become_free_city = {
	#log = "[Root.GetName]: Triggered become_free_city"
	events = {
        
	}
}

on_remove_free_city = {
	#log = "[Root.GetName]: Triggered remove_free_city"
	events = {
        
	}
}

on_revoke_estate_land_ai = {
	#log = "[Root.GetName]: Triggered revoke_estate_land_ai" #AI can't handle the rebels atm or perform a gradual revoke, sorry
	add_province_modifier = {
		name = revoked_estate_modifier
		duration = 5475 #15 years
	}
}

on_revoke_estate_land = {
	#log = "[Root.GetName]: Triggered revoke_estate_land"
	add_province_modifier = {
		name = revoked_estate_modifier
		duration = 5475 #15 years
	}
}

on_revoke_estate_land_ai_post = {
	#log = "[Root.GetName]: Triggered revoke_estate_land_ai_post"
	add_local_autonomy = 25
}
on_revoke_estate_land_post = {
	#log = "[Root.GetName]: Triggered revoke_estate_land_post"
	add_local_autonomy = 25
}

on_grant_estate_land = {
	#log = "[Root.GetName]: Triggered grant_estate_land"
	if = {
		limit = {
			has_province_modifier = revoked_estate_modifier
		}
		remove_province_modifier = revoked_estate_modifier
	}
}

on_death_has_harem = {
	#log = "[Root.GetName]: Triggered death_has_harem"
}

on_select_heir_from_harem = {
	#log = "[Root.GetName]: Triggered select_heir_from_harem"
}

on_fetishist_cult_change = {
	#log = "[Root.GetName]: Triggered fetishist_cult_change"
}

# country
on_gain_great_power_status = {
	#log = "[Root.GetName]: Triggered gain_great_power_status"
	if = {
		limit = {
			NOT = { has_country_flag = became_great_power_flag }
		}
		set_country_flag = became_great_power_flag
	}
}

# country
on_lose_great_power_status = {
	#log = "[Root.GetName]: Triggered lose_great_power_status"
}

# province
on_province_religion_converted = {
	#log = "[Root.GetName]: Triggered province_religion_converted"
	owner = {
		change_variable = {
			which = religions_converted
			value = 1
		}
	}
    
    if = {
        limit = {
            has_province_modifier = religious_persecution
        }
        remove_province_modifier = religious_persecution
    }
	
	if = {
		limit = {
			religion = fel
			trade_goods = arcane
		}
		change_trade_goods = fel
	}
	
	if = {
		limit = {
			religion = cult_of_the_damned
			trade_goods = arcane
		}
		change_trade_goods = fel
	}
	
	if = {
		limit = {
			NOT = { religion = fel }
			NOT = { religion = cult_of_the_damned }
			trade_goods = fel
		}
		change_trade_goods = arcane
	}
    
    on_province_religion_converted_estate_privileges_effect = yes
}

# province
on_province_culture_converted = {
	#log = "[Root.GetName]: Triggered province_culture_converted"
	owner = {
		change_variable = {
			which = cultures_converted
			value = 1
		}
	}
	
	if = {
		limit = {
			culture_group = culture_group_scourge
			trade_goods = grain
		}
		change_trade_goods = crypts
	}
	
	if = {
		limit = {
			culture_group = culture_group_undead
			trade_goods = grain
		}
		change_trade_goods = crypts
	}
	
#	if = {
#		limit = {
#			NOT = { culture_group = culture_group_scourge }
#			trade_goods = crypts
#		}
#		change_trade_goods = grain
#	}
	
}

# THIS = Province, FROM = Country who Propogated
on_convert_by_trade_policy = {
	#log = "[Root.GetName]: Triggered convert_by_trade_policy"
}

# province
# FROM = old owner
on_province_owner_change = {
	#log = "[Root.GetName]: Triggered province_owner_change"
    on_province_owner_change_estate_privileges_effect = yes
    
	owner = {
		change_variable = {
			which = provinces_gained
			value = 1
		}
		
	}
    
	if = {
		limit = {
			culture_group = culture_group_scourge
			trade_goods = grain
		}
		change_trade_goods = crypts
	}
	
	if = {
		limit = {
			culture_group = culture_group_undead
			trade_goods = grain
		}
		change_trade_goods = crypts
	}
	
#	if = {
#		limit = {
#			NOT = { culture_group = culture_group_scourge }
#			trade_goods = crypts
#		}
#		change_trade_goods = grain
#	}
	
	if = {
		limit = {
			religion = fel
			trade_goods = arcane
		}
		change_trade_goods = fel
	}
	
	if = {
		limit = {
			religion = cult_of_the_damned
			trade_goods = arcane
		}
		change_trade_goods = fel
	}
	
	if = {
		limit = {
			NOT = { religion = fel }
			NOT = { religion = cult_of_the_damned }
			trade_goods = fel
		}
		change_trade_goods = arcane
	}
	
	if = {
		limit = {
			province_id = 1671
		}
		owner = {
			add_country_modifier = {
				name = lord_of_outland
				duration = -1
			}
		}
		FROM = { remove_country_modifier = lord_of_outland }
	}
	
    on_province_owner_change_update_goods_production = yes
}

# country
on_parliament_debate_failed = {
	#log = "[Root.GetName]: Triggered parliament_debate_failed"
}

# country
on_parliament_debate_succeeded = {
	#log = "[Root.GetName]: Triggered parliament_debate_succeeded"
}

# Harmony
on_harmonized_order = {
    events = {
        wwu_harmonization.1
    }
}
on_harmonized_disorder = {
    events = {
        wwu_harmonization.2
    }
}
on_harmonized_life = {
    events = {
        wwu_harmonization.4
    }
}
on_harmonized_death = {
    events = {
        wwu_harmonization.7
    }
}
on_harmonized_shadow = {
    events = {
        wwu_harmonization.5
    }
}
on_harmonized_elemental = {
    events = {
        wwu_harmonization.3
    }
}
on_harmonized_philosophy = {
    events = {
        wwu_harmonization.6
    }
}
on_harmonized_holy_light = {
    events = {
        wwu_harmonization.20
    }
}
on_harmonized_scarlet_light = {
    events = {
        wwu_harmonization.21
    }
}
on_harmonized_argent_light = {
    events = {
        wwu_harmonization.22
    }
}
on_harmonized_light_of_the_naaru = {
    events = {
        wwu_harmonization.23
    }
}
on_harmonized_light_of_the_sunwell = {
    events = {
        wwu_harmonization.24
    }
}


# country
on_russian_sudebnik = {
	#log = "[Root.GetName]: Triggered russian_sudebnik"

}

# country
on_russian_oprichnina = {
	#log = "[Root.GetName]: Triggered russian_oprichnina"

}

# country
on_russian_streltsy = {
	#log = "[Root.GetName]: Triggered russian_streltsy"

}

# province
on_consecrate_patriarch = {
	#log = "[Root.GetName]: Triggered consecrate_patriarch"
}

# country. from = overlord
on_accept_tribute = {
	#log = "[Root.GetName]: Triggered accept_tribute"
}

# country. from = overlord
on_refuse_tribute = {
	#log = "[Root.GetName]: Triggered refuse_tribute"
}

# country
on_leader_recruited = {
	#log = "[Root.GetName]: Triggered leader_recruited"
}

# country
on_general_recruited = {
	#log = "[Root.GetName]: Triggered general_recruited"
	add_army_professionalism = 0.02
}

# country
on_admiral_recruited = {
	#log = "[Root.GetName]: Triggered admiral_recruited"
}

# country
on_conquistador_recruited = {
	#log = "[Root.GetName]: Triggered conquistador_recruited"
}

# country
on_explorer_recruited = {
	#log = "[Root.GetName]: Triggered explorer_recruited"
}

# THIS = Province, FROM = Country
on_regiment_recruited = {

}

# THIS = Province, FROM = Country
on_mercenary_recruited = {
	#log = "[Root.GetName]: Triggered mercenary_recruited"
	FROM = {
		add_army_professionalism = -0.0015
	}
}

# THIS = One province in the state
on_add_pasha = {
	#log = "[Root.GetName]: Triggered add_pasha"
}

# THIS = One province in the state
on_remove_pasha = {
	#log = "[Root.GetName]: Triggered remove_pasha"
	hidden_effect = {
		owner = {
			save_event_target_as = province_owner
		}
		remove_province_modifier = pasha_removed_modifier
	}

	area = {
		limit = { owned_by = event_target:province_owner }
		add_or_extend_province_modifier_effect = { MODIFIER = pasha_removed_modifier DURATION = 3650 }
	}
}

# THIS = Province
on_janissaries_raised = {
	#log = "[Root.GetName]: Triggered janissaries_raised"
}

# THIS = Province
on_revolutionary_guard_raised = {
    #log = "[Root.GetName]: Triggered on_revolutionary_guard_raised"
}

on_reform_enacted = {
	#log = "[Root.GetName]: Triggered reform_enacted"
}

on_reform_changed = {
	#log = "[Root.GetName]: Triggered reform_changed"
}

on_trade_company_investment = {
	#log = "[Root.GetName]: Triggered trade_company_investment"
}

on_center_of_trade_upgrade = {
	#log = "[Root.GetName]: Triggered center_of_trade_upgrade"
	owner = { change_variable = {
		which = cot_upgraded
		value = 1
	} }
}

on_center_of_trade_downgrade = {
	#log = "[Root.GetName]: Triggered center_of_trade_downgrade"

}

on_culture_promoted = {
	#log = "[Root.GetName]: Triggered culture_promoted"
	change_variable = {
		which = cultures_promoted
		value = 1
	}
}

# FROM = Previous Country, ROOT = Province
on_company_chartered = {
	#log = "[Root.GetName]: Triggered company_chartered"
}

# ROOT = Overlord, FROM = Minor
on_dependency_gained = {
	#log = "[Root.GetName]: Triggered dependency_gained"
	
}

# ROOT = Overlord, FROM = Minor
on_dependency_lost = {
	#log = "[Root.GetName]: Triggered dependency_lost"

}

# ROOT = New vassal, FROM = Overlord
on_create_vassal = {
	#log = "[Root.GetName]: Triggered create_vassal"
}

# ROOT = Country establishing it
# First province in state is set
on_holy_order_established = {
	#log = "[Root.GetName]: Triggered holy_order_established"

}

# When a minority is expelled to a colony
# THIS = Colony, ROOT = Colony, FROM = Home province
on_minority_expelled = {
	#log = "[Root.GetName]: Triggered minority_expelled"

}

# THIS = Raiding country, FROM = Sea province
on_raid_coast = {
	#log = "[Root.GetName]: Triggered raid_coast"
	if = {
		limit = {
			has_faction = pr_buccaneers
		}
		add_faction_influence = {
			faction = pr_buccaneers
			influence = 1
		}
	}
}

# ROOT = Tag that captured the flagship, FROM = Tag that lost the flagship
on_flagship_captured = {
	#log = "[Root.GetName]: Triggered flagship_captured"
	FROM = {
		set_country_flag = captured_flagship_country_flag
	}
	ROOT = {
		country_event = { id = flagship_events.2 }
		set_country_flag = trophy_hunter_flag
	}
	FROM = {
		country_event = { id = flagship_events.1 }
	}
}

# ROOT = Tag that destroyed the flagship, FROM = Tag that lost the flagship
on_flagship_destroyed = {
	#log = "[Root.GetName]: Triggered flagship_destroyed"
	FROM = {
		set_country_flag = sunk_flagship_country_flag
	}
	ROOT = {
		country_event = { id = flagship_events.4 }
	}
	FROM = {
		country_event = { id = flagship_events.3 }
	}
}

# this = Released country, FROM = Releasing country
on_country_released = {
	#log = "[Root.GetName]: Triggered country_released"
    FROM = {
        if = {
            limit = {
                has_reform = wwu_idealism_honor
            }
            add_adm_power = 100
            add_dip_power = 100
            add_mil_power = 100
        }
    }
}

# ROOT = province, FROM = country
on_trade_good_changed = {
	#log = "[Root.GetName]: Triggered trade_good_changed"

	on_trade_good_changed_estate_privileges_effect = yes
    # REFORM UPDATE
	# if = {
		# limit = {
			# OR = {
				# has_province_modifier = wine_bonus_prod
				# has_province_modifier = grain_bonus_prod
			# }
			# FROM = { has_reform = wwu_monastic_breweries_reform }
			# NOT = { owner = { has_reform = wwu_monastic_breweries_reform } }
		# }
		# remove_province_modifier = wine_bonus_prod
		# remove_province_modifier = grain_bonus_prod
	# }
	# hidden_effect = {
		# if = {
			# limit = {
				# trade_goods = wine
			# }
			# remove_province_modifier = grain_bonus_prod
			# add_province_modifier = { 
				# name = wine_bonus_prod
				# duration = -1
				# hidden = yes
			# }
		# }
		# if = {
			# limit = {
				# trade_goods = grain
			# }
			# remove_province_modifier = wine_bonus_prod
			# add_province_modifier = { 
				# name = grain_bonus_prod
				# duration = -1
				# hidden = yes
			# }
		# }
	# }
}

# this = country
on_loan_repaid = {
	#log = "[Root.GetName]: Triggered loan_repaid"

    on_loan_repaid_estate_privileges_effect = yes
}

# this = country
on_rebels_break_country = {
	#log = "[Root.GetName]: Triggered rebels_break_country"
	add_country_modifier = {
		name = just_lost_to_rebels
		duration = 10
		hidden = yes
	}
}

# this = country
## Fires when you fire or replace your ADM advisor, in the moment before they are actually removed from their post.
## Note: Defining a new advisor here will result in the shortest appointment in history. Use on_post_adm_advisor_fired instead :)
on_pre_adm_advisor_fired = {
	#log = "[Root.GetName]: Triggered pre_adm_advisor_fired"
	if = {
		limit = {
			has_country_flag = need_to_fire_adm_advisor
		}
		set_country_flag = just_fired_adm_advisor
		remove_advisor_by_category_no_action = ADM
	}
}

# this = country
on_pre_dip_advisor_fired = {
	#log = "[Root.GetName]: Triggered pre_dip_advisor_fired"
	if = {
		limit = {
			has_country_flag = need_to_fire_dip_advisor
		}
		set_country_flag = just_fired_dip_advisor
		remove_advisor_by_category_no_action = DIP
	}
}

# this = country
on_pre_mil_advisor_fired = {
	#log = "[Root.GetName]: Triggered pre_mil_advisor_fired"
	if = {
		limit = {
			has_country_flag = need_to_fire_mil_advisor
		}
		set_country_flag = just_fired_mil_advisor
		remove_advisor_by_category_no_action = MIL
	}
}

# this = country
on_post_adm_advisor_fired = {
	#log = "[Root.GetName]: Triggered post_adm_advisor_fired"

}

# this = country
on_post_dip_advisor_fired = {
	#log = "[Root.GetName]: Triggered post_dip_advisor_fired"
	
}

# this = country
on_post_mil_advisor_fired = {
	#log = "[Root.GetName]: Triggered post_mil_advisor_fired"
	
}

# this = new client state, from = parent country
on_create_client_state = {
	#log = "[Root.GetName]: Triggered create_client_state"
	
}

# this = new target, from = previous target (both can be non-existent tag)
on_change_revolution_target = {
	#log = "[Root.GetName]: Triggered change_revolution_target"
}

# this = curia controller (enactor of the bull)
on_golden_bull_enacted = {
	#log = "[Root.GetName]: Triggered golden_bull_enacted"
	set_country_flag = enacted_golden_bull
}


# province:  spawned whenever a new owner takes over the province
# FROM = The previous owner.
on_conquest = {
	#log = "[Root.GetName]: Triggered conquest"
	remove_named_unrest = estate_land_seized
}

on_country_creation = {
	#log = "[Root.GetName]: Triggered country_creation"
}

on_federation_leader_change = {
	if = {
		limit = { tag = FROM }
		disband_federation = THIS
	}
	else = {
		# New strongest member becomes the new federation leader
		set_federation_leader = THIS
	}
}

#FROM = country pillaged, ROOT = country doing the pillaging
on_pillaged_capital = {
}

#FROM = country dev was transferred from, ROOT = country doing the transferring
on_transfer_development = {
}

on_colonial_type_change = {
	clr_country_flag = encourage_cash_crops_flag
}

on_estate_led_regency = {
}

on_estate_led_regency_surpassed = {
    
}

on_extended_regency = {
	
}

